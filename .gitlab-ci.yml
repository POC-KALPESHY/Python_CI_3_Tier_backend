stages:
  - test

test:
  stage: test
  image: python:3
  script:
    - pip install pytest-mock
    - pip install requests pytest pytest-cov
    - pytest --cov --cov-report term --cov-report xml:coverage.xml
    
    # Uncommented the above line to generate coverage.xml
    # - pytest test_endpoint.py --endpoint-url 'http://your-endpoint-url'

  coverage: '/TOTAL.*? (100(?:\.0+)?\%|[1-9]?\d(?:\.\d+)?\%)$/'

  artifacts:
    reports:
      junit: test/test/report.xml
    paths:
      - test/coverage.xml
